/*SESSION-03*/

DROP TABLE EMPLOYEE_22BAI1347;
DROP TABLE DEPARTMENT_22BAI1347;
DROP TABLE CUMULATIVE_22BAI1347;

CREATE TABLE DEPARTMENT_22BAI1347(
	DEPT_NO VARCHAR(3) PRIMARY KEY,
	DEPT_NAME VARCHAR(20),
	LOCATION VARCHAR(10)
);

CREATE TABLE EMPLOYEE_22BAI1347(
	EMP_NO VARCHAR(6) PRIMARY KEY,
	EMP_NAME VARCHAR(20),
	DOB DATE,
	ADDRESS VARCHAR(20),
	DOJ DATE,
	MOBILE_NO INT,
	DEPT_NO REFERENCES DEPARTMENT_22BAI1347(DEPT_NO),
	SALARY INT
);

ALTER TABLE EMPLOYEE_22BAI1347 
ADD DESIGNATION VARCHAR(20);

ALTER TABLE EMPLOYEE_22BAI1347 
ADD CONSTRAINT DESIG_CONST CHECK (DESIGNATION LIKE 'EM%'); 

INSERT INTO DEPARTMENT_22BAI1347 VALUES('D01', 'ENGINEERING', 'CHENNAI');
INSERT INTO DEPARTMENT_22BAI1347 VALUES('D02', 'SOFTWARE', 'CHENNAI');
INSERT INTO DEPARTMENT_22BAI1347 VALUES('D03', 'HARDWARE', 'BANGALORE');
INSERT INTO DEPARTMENT_22BAI1347 VALUES('D04', 'BACKEND', 'MUMBAI');
INSERT INTO DEPARTMENT_22BAI1347 VALUES('D05', 'FRONTEND', 'DELHI');


INSERT INTO EMPLOYEE_22BAI1347 VALUES('12345A', 'ABCD', '01/JAN/1990', 'CHENNAI', '15/NOV/2015', 123456789, 'D01', 55000, 'EM_EMPLOYEE');
INSERT INTO EMPLOYEE_22BAI1347 VALUES('67890A', 'EFIGH', '01/FEB/1990', 'BENGALURU', '15/DEC/2015', 987654321, 'D02', 61000, 'EM_MANAGER');
INSERT INTO EMPLOYEE_22BAI1347 VALUES('12345B', 'IJKL', '01/MAR/1990', 'DELHI', '15/JAN/2016', 9999955555, 'D01', 57000, 'EM_EMPLOYEE');
INSERT INTO EMPLOYEE_22BAI1347 VALUES('67890B', 'JOHN', '01/APR/1990', 'DELHI', '15/FEB/2016', 098765231, 'D04', 65000, 'EM_TYPIST');
INSERT INTO EMPLOYEE_22BAI1347 VALUES('12345C', 'QRST', '01/MAY/1990', 'KOLKATA', '15/MAR/2016', 987654356, 'D02', 59000, 'EM_DIRECTOR');

SELECT DISTINCT(DESIGNATION) FROM EMPLOYEE_22BAI1347;

SELECT DISTINCT(DEPT_NO) AS DEPARTMENT_ID, SUM(SALARY) AS TOTAL_SALARY 
FROM EMPLOYEE_22BAI1347 GROUP BY DEPT_NO;

UPDATE EMPLOYEE_22BAI1347 SET SALARY=25000 
WHERE DESIGNATION='EM_TYPIST';

UPDATE EMPLOYEE_22BAI1347 SET MOBILE_NO=9999988888
WHERE EMP_NAME='JOHN';

DELETE FROM EMPLOYEE_22BAI1347 WHERE EMP_NO='12345C';

DELETE FROM EMPLOYEE_22BAI1347 WHERE SALARY=57000;

CREATE TABLE CUMULATIVE_22BAI1347 AS
SELECT EMPLOYEE_22BAI1347.*, DEPARTMENT_22BAI1347.DEPT_NAME
FROM EMPLOYEE_22BAI1347
INNER JOIN DEPARTMENT_22BAI1347 ON EMPLOYEE_22BAI1347.DEPT_NO = DEPARTMENT_22BAI1347.DEPT_NO;

UPDATE CUMULATIVE_22BAI1347
SET SALARY=SALARY + (0.25 * SALARY)
WHERE DEPT_NAME='SOFTWARE';

SELECT EMP_NAME, SALARY FROM EMPLOYEE_22BAI1347
WHERE SALARY BETWEEN 50000 AND 90000;

SELECT EMP_NAME FROM EMPLOYEE_22BAI1347
WHERE ADDRESS LIKE '%DE%';

SELECT EMP_NAME FROM EMPLOYEE_22BAI1347 
WHERE EMP_NAME LIKE 'AB%';

SELECT EMP_NAME FROM EMPLOYEE_22BAI1347 
WHERE EMP_NAME LIKE '%GH';

SELECT EMP_NAME FROM EMPLOYEE_22BAI1347 
WHERE EMP_NAME LIKE '_____';

SELECT EMP_NAME FROM EMPLOYEE_22BAI1347
ORDER BY EMP_NAME;

SELECT EMP_NAME FROM EMPLOYEE_22BAI1347
ORDER BY EMP_NAME DESC;

SELECT DISTINCT(DEPT_NO) AS DEPARTMENT_ID, AVG(SALARY) AS AVERAGE_SALARY
FROM EMPLOYEE_22BAI1347
GROUP BY DEPT_NO;

SELECT DISTINCT(DEPT_NO) AS DEPARTMENT_ID, SUM(SALARY) AS TOTAL_SALARY
FROM EMPLOYEE_22BAI1347
GROUP BY DEPT_NO
HAVING SUM(SALARY)>50000;

SELECT COUNT(*) AS TOTAL_EMPLOYEES
FROM EMPLOYEE_22BAI1347;

SELECT AVG(SALARY) AS AVERAGE_SALARY, MIN(SALARY) AS MIN_SALARY, MAX(SALARY) AS MAX_SALARY
FROM EMPLOYEE_22BAI1347;
