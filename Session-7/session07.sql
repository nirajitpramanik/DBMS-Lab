/*Session-07*/

DROP TABLE RATING_1347;
DROP TABLE MOVIE_1347;
DROP TABLE REVIEWER_1347;
DROP TABLE PRODUCTS_1347;

DROP TABLE NEW_ALL_1347;
DROP TABLE NEW_2_1347;
DROP TABLE NEW_ALLM_1347;

DROP VIEW HIGHRATING_1347;
DROP VIEW NORATING_1347;
DROP VIEW LATERATING_1347;

CREATE TABLE MOVIE_1347(
	mID INT PRIMARY KEY,
	TITLE VARCHAR(30),
	RELEASE_YEAR INT,
	DIRECTOR VARCHAR(30)
);

CREATE TABLE REVIEWER_1347(
	rID INT PRIMARY KEY,
	rname VARCHAR(30)
);

CREATE TABLE RATING_1347(
	rID INT,
	mID INT,
	STARS INT,
	rDate DATE,
	FOREIGN KEY(rID) REFERENCES REVIEWER_1347(rID),
	FOREIGN KEY(mID) REFERENCES MOVIE_1347(mID)
);

INSERT INTO MOVIE_1347 VALUES (1, 'MOVIE1', 2010, 'DIR1');
INSERT INTO MOVIE_1347 VALUES (2, 'MOVIE2', 2011, 'DIR2');
INSERT INTO MOVIE_1347 VALUES (3, 'MOVIE3', 2012, 'DIR3');
INSERT INTO MOVIE_1347 VALUES (4, 'MOVIE4', 2013, 'MDIR4');
INSERT INTO MOVIE_1347 VALUES (5, 'MOVIE5', 2014, 'MDIR5');
INSERT INTO MOVIE_1347 VALUES (6, 'MOVIE6', 2015, 'MDIR6');

INSERT INTO REVIEWER_1347 VALUES (1, 'REVIEWER1');
INSERT INTO REVIEWER_1347 VALUES (2, 'REVIEWER2');
INSERT INTO REVIEWER_1347 VALUES (3, 'REVIEWER3');

INSERT INTO RATING_1347 VALUES (1, 1, 4, '10/JAN/2010');
INSERT INTO RATING_1347 VALUES (1, 2, 5, '22/MAR/2011');
INSERT INTO RATING_1347 VALUES (2, 3, 2, '03/APR/2012');
INSERT INTO RATING_1347 VALUES (2, 4, 3, '15/JUN/2013');
INSERT INTO RATING_1347 VALUES (3, 5, 3, '08/SEP/2014');
INSERT INTO RATING_1347 VALUES (3, 6, 0, NULL);


--Question 1
CREATE TABLE NEW_ALL_1347 AS
(SELECT * FROM MOVIE_1347);

SELECT * FROM NEW_ALL_1347;

--Question 2
CREATE TABLE NEW_2_1347 AS
(SELECT mID, TITLE FROM MOVIE_1347);

SELECT * FROM NEW_2_1347;

--Question 3
CREATE TABLE NEW_ALLM_1347 AS
(SELECT * FROM MOVIE_1347
WHERE DIRECTOR LIKE 'M%');

SELECT * FROM NEW_ALLM_1347;

--Question 4
CREATE VIEW HIGHRATING_1347 AS
SELECT mID, TITLE
FROM MOVIE_1347
WHERE mID IN (SELECT mID FROM RATING_1347 WHERE STARS > 3);

--Question 5
CREATE VIEW NORATING_1347 AS
SELECT mID, TITLE
FROM MOVIE_1347
WHERE mID IN (SELECT mID FROM RATING_1347 WHERE STARS = 0);

--Question 6
CREATE VIEW LATERATING_1347 AS
SELECT mID, TITLE
FROM MOVIE_1347
WHERE mID IN (SELECT mID FROM RATING_1347 WHERE STARS > 3);

--Question 7
SELECT view_name FROM user_views;

--Question 8
UPDATE HIGHRATING_1347 
SET TITLE = 'MOVIE_1' 
WHERE mID = 1; 

--Question 9
DROP VIEW NORATING_1347;

--Question 10
CREATE SYNONYM SYN_REVIEWER_1347 FOR REVIEWER_1347;

--Question 11
DROP SYNONYM SYN_REVIEWER_1347;

--Question 12
CREATE TABLE PRODUCTS_1347(
	PID INT PRIMARY KEY,
	PNAME VARCHAR(30),
	PRICE INT
);

--Question 13
CREATE SEQUENCE SEQ1 
START WITH 1 
MINVALUE 1 
MAXVALUE 400;  

--Question 14
INSERT INTO PRODUCTS_1347 VALUES (SEQ1.NEXTVAL, 'PRODUCT1', 10.99); 
INSERT INTO PRODUCTS_1347 VALUES (SEQ1.NEXTVAL, 'PRODUCT2', 20.50); 
INSERT INTO PRODUCTS_1347 VALUES (SEQ1.NEXTVAL, 'PRODUCT3', 15.75);

SELECT * FROM PRODUCTS_1347;

--Question 15
ALTER SEQUENCE SEQ1 INCREMENT BY 100;

 INSERT INTO PRODUCTS_1347 VALUES (SEQ1.NEXTVAL, 'PRODUCT4', 30.25); 
 INSERT INTO PRODUCTS_1347 VALUES (SEQ1.NEXTVAL, 'PRODUCT5', 25.99);
 INSERT INTO PRODUCTS_1347 VALUES (SEQ1.NEXTVAL, 'PRODUCT6', 18.52); 

SELECT * FROM PRODUCTS_1347; 

--Question 16
DROP SEQUENCE SEQ1;
